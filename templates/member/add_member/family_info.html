{% extends "base/index.html" %}
{% load static %}

{% block corecss %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/member_list.css' %}">
{% endblock corecss %}

{% block title %}
    <title>Family Information</title>
{% endblock title %}

{% block content %}
<form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <table class="table">
        <thead>
            <tr>
                <th>Family Member Name</th>
                <th>Relationship</th>
                <th>Date of Birth</th>
                <th>Citizenship No</th>
                <th>Issued From</th>
                <th>Issued Date</th>
                <th>Education</th>
                <th>Occupation</th>
                <th>Monthly Income</th>
                <th>Phone Number</th>
            </tr>
        </thead>
        <tbody id="form-table-body">
            {% for form in forms %}
            <tr>
                <td>{{ form.family_member_name }}</td>
                <td>{{ form.relationship }}</td>
                <td>{{ form.date_of_birth }}</td>
                <td>{{ form.citizenship_no }}</td>
                <td>{{ form.issued_from }}</td>
                <td>{{ form.issued_date }}</td>
                <td>{{ form.education }}</td>
                <td>{{ form.occupation }}</td>
                <td>{{ form.monthly_income }}</td>
                <td>{{ form.phone_number }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <button type="button" id="add-member-btn" class="btn btn-secondary">Add Another Member</button>
    <button type="submit" class="btn btn-primary">Submit</button>
</form>

<script>
    document.getElementById('add-member-btn').addEventListener('click', function() {
        const formCount = document.querySelectorAll('tbody tr').length;
        fetch(`/get_new_form/?count=${formCount}`, {
            method: 'GET',
        })
        .then(response => response.json())
        .then(data => {
            const newFormRow = data.form_html;
            const tableBody = document.getElementById('form-table-body');
            tableBody.insertAdjacentHTML('beforeend', newFormRow);
        });
    });
</script>

{% endblock content %}
